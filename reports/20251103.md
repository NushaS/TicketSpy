# Team Report
### Project meeting agenda
1. Sharing progress & issues and plans & goals sections from status report
2. Request status report feedback for improving during the upcoming week
3. Review feedback from project architecture submission
4. Miscellaneous Q & A time (upcoming deadlines, sticking points, procedural questions, etc.)

# Team Goals
## Last week's goals
  - Continue developing our current naive version of the app interface to more closely represent our design goal. Focus mainly on the home page/login options for this week (Front-end team)
    - Time estimate: 4 days
  - Long term goal: Have heatmap coloring that has full coverage of the map and is accurate to ticket reports (front-end + backend)
    - Time estimate: Develop next week
  - Prepare for class Demo of TicketSpy: finalize functionality/prepare to present if necessary (everyone)
    - Time estimate: 2 days

## Progress and issues
- Completed Demo slides
- Challenges/things that we had trouble with include:
  - `user_id` foreign key issues: the user table that is used for logging in users is not the same user table that is referenced by the `bookmarks` and `parking_sessions` table, which is causing unexpected behavior for logged in users (cannot access their bookmarks)
  - Ensuring uniformity across log in, sign up, and forgot password pages
  - Post-ticket route was very difficult to implement. Managed to get it working w/ group of Tim + Abigail + Leo but still need to re-implement data validation.


## Plans and goals for the next week
Front end: 
  - Make logged in map page UI
  - Make logged-in version of pop up when user clicks on a location, displays “report parking enforcement” “report ticket” “start parking session” “bookmark this spot”
  - Make parking enforcement officer sighting confirmation pop up after clicking “report parking enforcement nearby” and then that needs to route to API endpoint for POST parking enforcement report
  - Make confetti or help or confirmation or something show up after successful report of ticket and parking enforcement report
  - Longer term goal: Make profile page UI

Back end: 
  - Make log in page route to logged in map page after successful log in (2 days)
  - Finish API route for POST parking enforcement and link the button for it (on report parking enforcement popup) to that route (3 days, but somewhat dependent on front end)
  - Make parking sessions API route - “start parking session button” will route to POST parking session API route (2 days)
  - Understand how to set up notifications for parking sessions for logged in users
  - Update `user_id` foreign key to use the correct user table
  - Longer term goal: get notifications set up for parking sessions and bookmarks, also set up POST bookmark APIi route

# Individual Contributions/Goals
## Last week's goals
1. Nusha:
  - Prepare for the demo on Thursday - 2 days
  - Make sure all buttons and pages on interface are at least reachable/clickable with Aya and Timofei - 2 days
  - Meet with Timofei to work out current TicketSpy interface and discuss our next steps (1 day)
  - Longterm goal: Implement auth pages using Supabase Auth UI and Tailwind forms (after demo)
2. Abigail:
  - Get ticket data from Supabase to display on website, likely with Leo, Timofei, and Ahana - 2 days
  - Implement ticket reporting (POST API) with Timofei (also likely Leo and Ahana) - 2 days
  - Make formatting nicer on website - 2 days
3. Timofei
  - Get TanStack query working - 2 days
  - Implement ticket reporting - 2 days
  - Implement filter button - 3 days
4. Ahana
  - Meet with Abigail + Tim for updates to Supabase as well with Leo (2 days)
  - Set up database security policies (1 day)
5. Aya
  - Incorporate components (icons, buttons, colors, and fonts) from the figma UI gallery that we created into the project frontend (2 days)
  - Scaffold a draft user guide from the current set of app features/user stories (1 day)
  - Implement frontend event handlers for button, form submission, pin placement rendering behavior (2-3 days)
6. Leo
  - Set up Database RLS policies (1 day)
  - *Meet with Abigail + Tim to go over / teach our (Ahana & I) changes of the Supabase + Tanstack query implementations
  - Lower priorities
  - CI/CD pipeline - Start testing Github actions mini-project (1 day)
  - Github branch workflow - Study Atlassian & lectures (1 day)

## Progress and issues
1. Nusha:
  - Met up with the team multiple times and helped breakdown who needs to be working on what, and dividing the features
  - Changed the map from displaying just the hotspots to a properly colored heatmap and ranges from light blue all the way to dark red
  - Learned on how transparent/dark I need to make colors to make them visible enough for users and also still be able to see the map beneath it
  - Added an opacity slider so that users can choose how transparent/visible they want the ticketing hotspots to be on the map
  - Had some issues with slider overlapping with the Filters button
  - Made the demo slides and worked on the Developer guide


2. Abigail: 
  - Worked with Leo to understand implementation of “get ticket data” (TanStack query calling Supabase, no intermediary API route)
  - Understood how service roles work, but struggled somewhat getting there
  - Worked on POST ticket API route, successfully was able to set up report ticket functionality. Struggled with Zod validation, but we were able to bypass it.
  - Made UI on website more aesthetically pleasing
  - Worked on understanding Supabase and RLS better
  - Learned more about API routing in Next.Js


3. Timofei: 
  - Helped with the post ticket API route. Made front-end popup for when map is pressed and the report ticket form.
  - Learned how API routing in next.js works and how to interact with Supabase
  - Stuck on the database and backend interface, got it worked out

4. Ahana:
  - Built api/post-enforcement route. Created a test-page to auto-submit a mock ticket and successfully was able to add a report to the database. Have not connected to the frontend, waiting for the frontend pop-up to be designed.
  - Issues: had many problems initially with getting the route to work. Realized I had to update my environment variables and match the schema in the table, finally was able to successfully submit

5. Aya:
  - Composed initial user guide draft.
  - Incorporated heart, car ticket, and officer sighting icons as new ui components to the project (they now live in `components/ui/icons`).
  - Updated styling for “create account” and “forgot password” pages to match that of the “log in” page. Also added heading text to differentiate “create account” and “log in” pages, and moved/updated the relevant stylesheet (from `auth/login` to `auth` to be more accessible for all auth pages)
  - Began working on the functionality for rendering car icon as pin for parking sessions and heart icon as pin for bookmarked locations on the map
  - Created a MapPin component and utility functions to support rendering icons as pins with MapLibre
  - Issues: initially implemented this globally (for all bookmarked locations and parking sessions in the app), and then updated the code to be user-specific, but ran into issues with `user_id` foreign key for the `bookmarks` and `parking_sessions` table; currently, this lives as a draft PR on github, and will be merged after updating the `user_id` logic/keys.

6. Leo:
  - Built w/ Tim & Abigail -> api/post-ticket route. Very difficult. Managed to create a test-page to auto-submit a mock ticket, then gave route to Tim to connect it to front-end
  - Issue: Data validation temporarily removed for now as many bugs
  - Tested TanStack query mutation for posting ticket. Helpful to learn, but deprecated code as we needed more functionality so we decided to build a custom api route instead of using tanStack query mutation
  - Fixed CI/CD pre-commit End-of-line ESLint error. Pushed config changes to have everyone’s OS use LF instead of CRLF

## 3. Plans and goals for the next week
1. Nusha:
  - Create option and pop up for Enforcement reporting and ensure it matches the style for the Ticket Reporting (3 days)
  - Add the filter options for the map for the user (2 days)
  - Create Thank you message for reporting your ticket and/or provide information on how to appeal your parking ticket (2 days)
  - Long-term goal: create bookmark interface
2. Abigail:
  - Set up parking sessions API route with Timofei and Leo (3 days)
  - Figure out how notifications work for logged in users (for parking sessions, but actual sending may be next next week) (2 days)
  - Reroute “log in” button when user logs in to the logged in map page rather than the protected page (dependent on front end creating that page) (2 days)
3. Timofei:
  - Setup parking sessions logic with Abigail (2 days)
  - Write tests for new features, ticket and enforcement reporting, basic alert functionality for parked users in radius (likely without notifications), component displaying (2 days)
  - Work on alerting parked users in radius, set up logic for sending notifications (actually sending may be week after) (3 days)
4. Ahana:
  - Connect api/post-enforcement route to frontend once it is finished (1 day)
  - Continue to learn TanStack and how we can implement it into our program since we didn’t use it for api routes (2 days)
5. Aya:
  - Look at supabase user id foreign key, test that the correct map pins show up for logged in user, and finalize the map pin rendering work (1 day)
  - Implement user icon in upper right corner for logged in user (to be the button to access the profile settings page) (2 days)
  - After API routes are in place for parking sessions, implement user parking session functionality (clicking map to park car, clicking parking icon to remove parking) (2 days) 
6. Leo:
  - *Connect auth.users to custom users table (3 days)
  - Give Nusha getUserData for main page “logged in” (1 day)
  - Revise schema once again just in case (1 day)
  - Fix PR (Feature/map pins #30)
  - Data validation for ticket posting (1 day)
